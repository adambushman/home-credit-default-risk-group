---
title: "Modeling for Default"
author: "Adam Bushman"
date: "2024-10-20"
output: html_document
---

## Approach

I'm focusing on modeling for `TARGET` using the below method(s): 

1.  Penalized Regression


## Prep

Let's load a few libraries:

```{r}
library('tidyverse')
library('glmnet')
```

We'll load the cleaned, training data:

```{r}
data <- data.table::fread('data/application_train_clean.csv') |>
    as.data.frame()

glimpse(data)
```

All features in this file may conceivably be helpful in predicting `DEFAULT` (originally named `TARGET`), with exception of `SK_ID_CURR`. We do, however, have  little to no way of knowing which will be predictive. Therefore, an elastic net is probably the best choice.

Let's prepare the data:

```{r}
target <- data$DEFAULT
predictors <- as.matrix(
    data[,-which(names(data) == "DEFAULT")]
)
```


## Basic Modeling

Let's run an elastic net model leveraging cross validation. We'll use the default 10 folds. The output we get will measure `AUC` and the standard error thereof.

```{r}
mod <- cv.glmnet(
    x = predictors, 
    y = target, 
    family = "binomial", 
    alpha = 0.5, 
    type.measure = "auc"
)

mod
```

Using an elastic net model, we're achievingg an AUC of `~0.73` with a standard error of `0.0012` with 25 variables. 

```{r}
plot(mod)
```

Let's look at the significant coefficients for the `1se` model since its VERY close to the absolute minimum in terms of performance:

```{r}
coef <- coef(mod, "lambda.1se")
coef_df <- as.data.frame(as.matrix(coef))
coef_df$Predictor <- rownames(coef)
colnames(coef_df)[1] <- "Coefficient"

coef_df |>
    select(Predictor, Coefficient) |>
    arrange(desc(abs(Coefficient)))
```

## Tuned Modeling



## Interaction terms

We're going to create some interaction terms, something to indicate a varying relationship between predictors.

We'll implement the following interactions, largely informed by data analysis work:

1.  `OCCUPATION_TYPE` and `AMT_INCOME_TOTAL`
4.  `NAME_EDUCATION_TYPE` and `
2.  `ORGANIZATION_TYPE` and `AMT_INCOME_TOTAL`
3.  `AMT_CREDIT` and `AMT_GOODS_PRICE`

```{r}
alt_data <-
    data |>
    mutate(

    )
```

```{r}
predictors_alt <- as.matrix(
    data[,-which(names(data) == "DEFAULT")]
)
```